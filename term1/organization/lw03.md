# Draft Plan 02 Oct

- go through **draft** grading system [15 min]
- go through **draft** learning week plans for hw and exams [5 min]
- go through rough task description of project in class (term 1 only) [5 min]
- advanced students can go on (share task description) [5 min]
- develop phase one lw03 from project [25 min]
- discuss homework deadline starts tomorrow [2 min]
- time for goal discussion (finalizing this week) [20 min]

Class Project 

Производствен проект – изчистена домейн-спецификация (изисквания за имплементация)

Обхват

Мини ERP за производство и логистика на една фирма. Следи материали (суровини/компоненти/готова продукция), складови наличности, вход/изход (INBOUND/OUTBOUND), вътрешни движения (WIP), поръчки от клиенти и производствени поръчки. Проектът е модулен и нарастващ; подреждай имплементацията по класове и връзки по-долу.

⸻

Базови концепции и константи
•	Uom (единица мярка): PCS, KG, L, …
•	MaterialType: RAW, COMPONENT, FINISHED.
•	MoveType: INBOUND, OUTBOUND, WIP_MOVE, TRANSFER.
•	Всички количества са цели или десетични числа ≥ 0. Наличност не пада под 0.

⸻

Класове и връзки

1) Company
   •	Полета: name:String, registrationId:String, plants:List<Plant>.
   •	Операции: addPlant(Plant), findPlant(id).
   •	Инвариант: поне един Plant преди да се приемат/изпращат стоки.

2) Plant (Завод/локация)
   •	Полета: id:String, name:String, address:String,
   warehouses:List<Warehouse>, productionUnits:List<ProductionUnit>,
   employees:List<Employee>.
   •	Операции: addWarehouse(Warehouse), addProductionUnit(ProductionUnit), assign(Employee).
   •	Инварианти: всяко движение на материал е в рамките на един Plant.

3) Warehouse (Склад)
   •	Полета: id:String, name:String, location:String,
   inventory:Map<Material, BigDecimal>, capacityOpt:BigDecimal?.
   •	Операции:
   stockOf(Material):BigDecimal,
   receive(Material, qty),
   issue(Material, qty),
   transferTo(Warehouse, Material, qty) (намалява тук, увеличава там),
   apply(Movement).
   •	Инварианти: issue валидира достатъчна наличност; transferTo е атомична.

4) Material (материал/артикул)
   •	Полета: id:String, name:String, type:MaterialType, uom:Uom,
   minStockOpt:BigDecimal?.
   •	Операции: isRaw(), isComponent(), isFinished().
   •	Заб.: Не е абстрактен; специализациите добавят данни.

4.1) RawMaterial extends Material
•	Допълнително: supplier:Supplier.

4.2) Product extends Material (готов продукт)
•	Допълнително: bom:List<BomItem>.
•	BomItem: component:Material, qtyPerUnit:BigDecimal.

5) Supplier
   •	Полета: id:String, name:String, contact:String.

6) Customer
   •	Полета: id:String, name:String, address:String, contact:String.

7) Employee
   •	Полета: id:String, name:String, role:EmployeeRole, plantId:String.
   •	EmployeeRole: PRODUCTION, LOGISTICS, WAREHOUSE, MANAGER.
   •	Инвариант: plantId валиден към съществуващ Plant.

8) Order (клиентска поръчка)
   •	Полета: id:String, customer:Customer, items:List<OrderItem>,
   status:OrderStatus, dueDate:LocalDate.
   •	OrderItem: product:Product, qty:BigDecimal.
   •	OrderStatus: NEW, ALLOCATED, FULFILLED, CANCELLED.
   •	Операции:
   allocateFrom(Warehouse) (резервира готова продукция),
   fulfillVia(Shipment).

9) ProductionOrder (производствена поръчка)
   •	Полета: id:String, plant:Plant, product:Product, qty:BigDecimal,
   status:ProdStatus, dueDate:LocalDate, consumed:Map<Material,BigDecimal>, produced:BigDecimal.
   •	ProdStatus: PLANNED, IN_PROGRESS, DONE, CANCELLED.
   •	Операции:
   start(),
   consumeFrom(Warehouse, Material, qty) → генерира Movement тип WIP_MOVE към производството,
   produceTo(Warehouse, qty) → връща произведеното във финален склад,
   isMaterialsCovered(Warehouse):boolean (според BOM).
   •	Инвариант: консумацията следва BOM: consumed[comp] ≥ qty * bom.qtyPerUnit(comp).

10) ProductionUnit (Производствен отдел/линия)
    •	Полета: id:String, name:String, focus:String?, logisticsNotes:String?.
    •	Връзка: принадлежи на Plant, работи по много ProductionOrder.

11) Movement (складово движение)
    •	Полета: id:String, timestamp:Instant, warehouse:Warehouse,
    material:Material, qty:BigDecimal, type:MoveType,
    ref:String? (OrderId/ProductionOrderId/ShipmentId/ReceivingId).
    •	Операции: apply() върху Warehouse.
    •	Инвариант: qty > 0. INBOUND увеличава, OUTBOUND намалява, WIP_MOVE намалява от склад → увеличава вътрешно в ProductionOrder (не пипа друг склад), TRANSFER е два атомични записа.

12) Receiving (входящо от доставчик)
    •	Полета: id:String, supplier:Supplier, items:List<ReceivingItem>, warehouse:Warehouse, status:ReceivingStatus.
    •	ReceivingItem: material:Material, qty:BigDecimal.
    •	Операции: post() → създава Movement INBOUND за всяка позиция.

13) Shipment (изходящо към клиент)
    •	Полета: id:String, customer:Customer, items:List<ShipmentItem>, warehouse:Warehouse, status:ShipmentStatus.
    •	ShipmentItem: material:Material, qty:BigDecimal.
    •	Операции: post() → OUTBOUND движения.
    •	Инвариант: всички артикули за клиента са FINISHED.

⸻

Поток на процесите (минимум)
1.	Доставка (INBOUND)
Receiving.post() → Movement(INBOUND) → наличност +.
2.	Планиране производство
ProductionOrder(product, qty) → проверка isMaterialsCovered(warehouse).
3.	Материали към производство (WIP)
За всеки компонент: consumeFrom(warehouse, mat, qty) → Movement(WIP_MOVE) → намалява склад.
4.	Производство готов продукт
produceTo(warehouse, qty) → наличност + на готов продукт.
5.	Клиентска поръчка и експедиция (OUTBOUND)
Order.allocateFrom(warehouse) → резервира количества.
Shipment.post() → Movement(OUTBOUND) → наличност –.
Order.status = FULFILLED.
6.	Трансфери
warehouseA.transferTo(warehouseB, mat, qty) → двойно движение (OUT при A, IN при B).

⸻

Инварианти и валидации
•	Няма отрицателна наличност.
•	Product има BOM само от RAW/COMPONENT.
•	OrderItem.product.type == FINISHED.
•	ReceivingItem.material.type != FINISHED е позволено (внасяме и готова продукция при нужда).
•	ShipmentItem.material.type == FINISHED.
•	Всички движения носят ref към източника (проследимост).

⸻

Мини API/методи за имплементация (насоки)
•	Warehouse.receive(m:q), Warehouse.issue(m:q), Warehouse.apply(Movement)
•	ProductionOrder.consumeFrom(wh, m, q); ProductionOrder.produceTo(wh, q)
•	Order.allocateFrom(wh); Order.fulfillVia(shipment)
•	Receiving.post(); Shipment.post()
•	Product.requiredComponentsFor(qty): Map<Material,BigDecimal>
•	InventoryService.balance(wh, m), InventoryService.canIssue(wh, m, q)

⸻

Данни за демонстрация
•	1 Company → 1 Plant.
•	2 склада: RAW_WH, FG_WH.
•	RawMaterial: Steel(kg), Screws(pcs).
•	Product: Chair(pcs) с BOM: Steel:5 kg, Screws:8 pcs.
•	1 Supplier, 1 Customer.
•	Поток: Receiving → ProductionOrder(Chair x10) → Shipment(Chair x5).

⸻

Нарастване по уроци (кратко)
•	W4–W6: Material, Warehouse, Movement, конзолен receive/issue/print.
•	W7–W9: Product + BOM, ProductionOrder с валидиране и WIP.
•	W10–W12: Order, Shipment, алокации, сортиране/търсене, Map/Set.
•	W13–W14: запазване във файл (CSV) на движения/инвентар, StringBuilder, Scanner.

⸻

Тестови случаи (минимум)
•	issue от празен склад → грешка.
•	transferTo с недостатъчно количество → грешка.
•	ProductionOrder.consumeFrom без достатъчно по BOM → грешка.
•	Успешен цикъл: INBOUND суровини → consume → produce → OUTBOUND готов продукт; крайни наличности са коректни.

⸻

Разширения (по желание)
•	Роли: ограничения кой прави post() на Receiving/Shipment.
•	Резервиране срещу поръчка (ALLOCATED количества).
•	Отчети: наличности към дата; проследимост по ref.
•	Record за неизменими DTO-та: MovementRecord, BomItemRecord.

Това е работещ, консистентен скелет. Имплементирай класовете точно по горните полета и операции. Всяка връзка е еднозначно дефинирана и проверима чрез инварианти.



# Draft Plan 03 Oct

- updates [ min]
- develop phase two lw03 from project [ min]
- individual work parallel to goal discussion [ min]
- 





